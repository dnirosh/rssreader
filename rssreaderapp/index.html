<!DOCTYPE html> 
<html> 
	<head> 
	<title>Movies and Games</title> 
<!--
<link rel="stylesheet" href="http://code.jquery.com/mobile/1.0a2/jquery.mobile-1.0a2.min.css" />	
<script src="http://code.jquery.com/jquery-1.4.4.min.js"></script>
<script src="http://code.jquery.com/mobile/1.0a2/jquery.mobile-1.0a2.min.js"></script>-->

<link rel="stylesheet" href="css-js/jquery.mobile-1.0a2.min.css" />	
<script src="css-js/jquery-1.4.4.min.js"></script>
<script src="css-js/jquery.mobile-1.0a2.min.js"></script>
<script src="css-js/jquery.ba-dotimeout.js"></script> 
<script src="css-js/jquery.dst.js"></script> 


</head> 
<body> 
<!-- Container page -->
<div data-role="page" data-theme="b" id="landPage">
	<div data-role="header" id="pageheader">
		<h1>Movies&Games</h1>
		
	</div>	
	
	<div data-role="content" id="buttonContent">
        <a data-role="button" href="#moviePage" id="movieButton">
            Movies
        </a>
        <a data-role="button" href="#gamePage" id="gameButton">
            Games
        </a>
	</div>
	
	<div data-role="content" id="welcomeContent">
		<h3> Welcome to the Movies and Games Application </h3>
		<h3> where you get to see only the hottest and latest of games'n movies over a beer !<h3>
	</div>

	
    <div id="mgfooter" data-theme="a" data-role="footer" data-position="fixed" >
        <h4>Powered by Exilesoft - Evening Brew </h4>
    </div>	 
</div>
<div data-role="page" data-theme="c" id="moviePage">
	<div data-role="content">    
        <ul id="linksList1" data-role="listview" data-inset="true"></ul>
    </div>
</div>
<div data-role="page" data-theme="d" id="gamePage">
	 <div data-role="content">    
        <ul id="linksList2" data-role="listview" data-inset="true"></ul>
    </div>
</div>	

	<script>
	    var contentRSSDescription = $('#contentRSSDescription');
		var movieRSSFeed = 'http://i.rottentomatoes.com/syndication/rss/upcoming.xml';
		var gameNewsRSSFeed = 'http://www.gamespot.com/feeds/news/';
		var gameNewReleasesRSSFeed = 'http://www.gamespot.com/feeds/new_releases/';
		
		$(document).ready(function () {   	   
			contentRSSDescription.html('sending req1...');
			
		});
		
		function getRSSData(handler,url){
			//$('#contentRSSDescription').load('http://lkr.fxexchangerate.com/rss.xml');
		
		    //var varURI = 'http://i.rottentomatoes.com/syndication/rss/upcoming.xml';
			
			$.ajax({type: 'GET', dataType: 'xml', url: url, success: handler ,
			beforeSend: function(xhr) {
				xhr.setRequestHeader("Access-Control-Allow-Origin", "*");
			},
			 error: function (xhr, textStatus, errorThrown) {
						contentRSSDescription.html('error:' + errorThrown);
					}
			});
		}
		
		function populate(xml){
			contentRSSDescription.html('debug.1');
			if(xml==null||xml=='')
			  contentRSSDescription.html('debug.xml is empty');
			else
		     contentRSSDescription.html($(xml).find("item").text());
			//alert(xml);
			var entries = [];
			var s = '';
			$(xml).find("item").each(function(i,v){
				entry = { 
						title:$(v).find("title").text(), 
						link:$(v).find("link").text(), 
						description:$.trim($(v).find("description").text())
					};
				entries.push(entry);
				s += '<ul><a href="#contentPage" class="contentLink" data-entryid="'+i+'">' + $(v).find("title").text() + '</a></ul>';

				contentRSSDescription.html($(this).find("description").text());
				
			});
			
			$("#linksList1").append(s);
			$("#linksList1").listview("refresh");
		    $("#linksList2").append(s);
			$("#linksList2").listview("refresh");
		}
		
		//Game functions
		function hideGame(){
			$("#gamePage").hide();
		}
		function showGame(){
			getRSSData(populate ,gameNewsRSSFeed);
			$("#gamePage").show();
		}
		function hideLandPage(){
			$("#buttonContent").hide();
			$("#welcomeContent").hide();
		};
		
		$('#gameButton').click(function() {
		  hideLandPage();
		  hideMovie();
		  showGame();
		  return false;      
		});
		
		//Movie functions
		function hideMovie(){
			$("#moviePage").hide();
		}
		function showMovie(){
		    getRSSData(populate ,movieRSSFeed);
			$("#moviePage").show();
		}
		
		$('#movieButton').click(function() {
		  hideLandPage();
		  hideGame();
		  showMovie();
		  return false;      
		});
		
	</script>

</body> 
</html> 